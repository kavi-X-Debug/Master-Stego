<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <title>Master Stego - CTF Image Steganography Analyzer</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="/favicon.ico">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: "Open Sans", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        }

        .font-mono,
        pre,
        code {
            font-family: "Open Sans", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        }

        .loading-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 50;
        }

        .loading-overlay.active {
            display: flex;
        }

        .ring {
            position: relative;
            width: 150px;
            height: 150px;
            background: transparent;
            border: 3px solid #3c3c3c;
            border-radius: 50%;
            text-align: center;
            line-height: 150px;
            font-family: sans-serif;
            font-size: 18px;
            color: #fff000;
            letter-spacing: 4px;
            text-transform: uppercase;
            text-shadow: 0 0 10px #fff000;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        }

        .ring::before {
            content: "";
            position: absolute;
            top: -3px;
            left: -3px;
            width: 100%;
            height: 100%;
            border: 3px solid transparent;
            border-top: 3px solid #fff000;
            border-right: 3px solid #fff000;
            border-radius: 50%;
            animation: animateC 2s linear infinite;
        }

        .ring span {
            display: block;
            position: absolute;
            top: calc(50% - 2px);
            left: 50%;
            width: 50%;
            height: 4px;
            background: transparent;
            transform-origin: left;
            animation: animate 2s linear infinite;
        }

        .ring span::before {
            content: "";
            position: absolute;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #fff000;
            top: -6px;
            right: -8px;
            box-shadow: 0 0 20px #fff000;
        }

        @keyframes animateC {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }

        @keyframes animate {
            0% {
                transform: rotate(45deg);
            }
            100% {
                transform: rotate(405deg);
            }
        }

        .wave-text span {
            display: inline-block;
            animation: waveTitle 2s ease-in-out infinite;
        }

        .wave-text span:nth-child(1) { animation-delay: 0s; }
        .wave-text span:nth-child(2) { animation-delay: 0.08s; }
        .wave-text span:nth-child(3) { animation-delay: 0.16s; }
        .wave-text span:nth-child(4) { animation-delay: 0.24s; }
        .wave-text span:nth-child(5) { animation-delay: 0.32s; }
        .wave-text span:nth-child(6) { animation-delay: 0.40s; }
        .wave-text span:nth-child(7) { animation-delay: 0.48s; }
        .wave-text span:nth-child(8) { animation-delay: 0.56s; }
        .wave-text span:nth-child(9) { animation-delay: 0.64s; }
        .wave-text span:nth-child(10) { animation-delay: 0.72s; }
        .wave-text span:nth-child(11) { animation-delay: 0.80s; }
        .wave-text span:nth-child(12) { animation-delay: 0.88s; }

        @keyframes waveTitle {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-4px);
            }
        }
    </style>
</head>
<body class="bg-black text-gray-100 min-h-screen">
<div class="min-h-screen flex flex-col">
    <header class="border-b border-gray-800 bg-gradient-to-r from-black via-gray-900 to-black">
        <div class="max-w-7xl mx-auto px-4 py-4 flex items-center justify-between">
            <div class="flex items-center space-x-3">
                <div class="w-8 h-8 rounded bg-emerald-500 flex items-center justify-center text-black font-bold">
                    MS
                </div>
                <div>
                    <h1 class="text-xl font-semibold tracking-wide wave-text">
                        <span>M</span><span>a</span><span>s</span><span>t</span><span>e</span><span>r</span><span>&nbsp;</span><span>S</span><span>t</span><span>e</span><span>g</span><span>o</span>
                    </h1>
                </div>
            </div>
            <div class="text-xs text-right text-gray-400"></div>
        </div>
    </header>

    <main class="flex-1">
        <div class="max-w-7xl mx-auto px-4 py-6 grid grid-cols-1 lg:grid-cols-4 gap-4">
            <section class="lg:col-span-1 space-y-4">
                <div class="bg-gray-900 border border-gray-800 rounded-lg p-4 space-y-3 transition-transform duration-300 hover:-translate-y-1 hover:border-emerald-500/70 hover:shadow-[0_0_24px_rgba(16,185,129,0.35)]">
                    <h2 class="text-sm font-semibold text-emerald-400 uppercase tracking-wide">Upload</h2>
                    <form id="analyze-form" class="space-y-3">
                        <input
                            id="image-input"
                            type="file"
                            accept=".png,.jpg,.jpeg,.bmp"
                            class="block w-full text-xs text-gray-300 file:mr-4 file:py-2 file:px-4 file:rounded file:border-0 file:text-xs file:font-semibold file:bg-emerald-500 file:text-black hover:file:bg-emerald-400 cursor-pointer"
                        />
                        <div class="flex space-x-2">
                            <button
                                type="submit"
                                class="flex-1 py-2 text-xs font-semibold rounded bg-emerald-500 text-black hover:bg-emerald-400 transition-transform duration-200 hover:-translate-y-0.5 hover:shadow-[0_0_18px_rgba(16,185,129,0.45)]"
                            >
                                Run All Tools
                            </button>
                            <button
                                type="button"
                                id="reset-button"
                                class="px-3 py-2 text-xs font-semibold rounded border border-gray-700 text-gray-200 hover:bg-gray-800 transition-transform duration-200 hover:-translate-y-0.5"
                            >
                                Reset
                            </button>
                        </div>
                    </form>
                    <p id="status-text" class="text-xs text-gray-400">Idle.</p>
                </div>

                <div class="bg-gray-900 border border-gray-800 rounded-lg p-4 transition-transform duration-300 hover:-translate-y-1 hover:border-emerald-500/70 hover:shadow-[0_0_24px_rgba(16,185,129,0.35)]">
                    <h2 class="text-sm font-semibold text-emerald-400 uppercase tracking-wide mb-2">Detected Flags</h2>
                    <div class="space-y-2 mb-3">
                        <label for="flag-pattern-input" class="block text-[10px] text-gray-400">Custom flag pattern (e.g. <span class="text-emerald-400">flag{}</span>)</label>
                        <div class="flex space-x-2">
                            <input
                                id="flag-pattern-input"
                                type="text"
                                placeholder="flag{}"
                                class="flex-1 bg-black/40 border border-gray-700 rounded px-2 py-1 text-[11px] text-gray-200 focus:outline-none focus:border-emerald-500"
                            />
                            <button
                                type="button"
                                id="flag-search-button"
                                class="px-2 py-1 text-[11px] font-semibold rounded bg-emerald-500 text-black hover:bg-emerald-400 transition"
                            >
                                Search
                            </button>
                        </div>
                    </div>
                    <div id="flags-container" class="space-y-2 text-xs max-h-40 overflow-auto">
                        <p class="text-gray-500">No flags detected yet.</p>
                    </div>
                    <div class="mt-3 border-t border-gray-800 pt-2">
                        <p class="text-[10px] text-gray-400 mb-1">Custom matches</p>
                        <div id="custom-flags-container" class="space-y-1 text-[11px] max-h-32 overflow-auto">
                            <p class="text-gray-500">No custom pattern searched.</p>
                        </div>
                    </div>
                </div>
                <div class="bg-gray-900 border border-gray-800 rounded-lg p-4 space-y-3 transition-transform duration-300 hover:-translate-y-1 hover:border-emerald-500/70 hover:shadow-[0_0_24px_rgba(16,185,129,0.35)]">
                    <h2 class="text-sm font-semibold text-emerald-400 uppercase tracking-wide">Gemini Assistant</h2>
                    <p class="text-[11px] text-gray-400">
                        Ask questions about the analysis to get hints and flag ideas.
                    </p>
                    <div id="chat-log" class="space-y-2 text-[11px] max-h-48 overflow-auto border border-gray-800 rounded p-2 bg-black/40">
                        <div class="text-gray-500">Run an analysis, then ask a question here.</div>
                    </div>
                    <div class="flex space-x-2">
                        <input
                            id="chat-input"
                            type="text"
                            placeholder="Ask Gemini about this image..."
                            class="flex-1 bg-black/40 border border-gray-700 rounded px-2 py-1 text-[11px] text-gray-200 focus:outline-none focus:border-emerald-500"
                        />
                        <button
                            type="button"
                            id="chat-send-button"
                            class="px-2 py-1 text-[11px] font-semibold rounded bg-emerald-500 text-black hover:bg-emerald-400 transition"
                        >
                            Send
                        </button>
                    </div>
                </div>
            </section>

            <section class="lg:col-span-3 space-y-4">
                <div class="bg-gray-900 border border-gray-800 rounded-lg flex flex-col lg:flex-row transition-transform duration-300 hover:-translate-y-1 hover:border-emerald-500/70 hover:shadow-[0_0_28px_rgba(16,185,129,0.4)]">
                    <div class="lg:w-1/3 border-b lg:border-b-0 lg:border-r border-gray-800">
                        <div class="p-3 border-b border-gray-800">
                            <h2 class="text-sm font-semibold text-emerald-400 uppercase tracking-wide">Modules</h2>
                        </div>
                        <nav id="tab-list" class="p-2 space-y-1 text-xs">
                            <button data-tab="file-info" class="tab-button w-full text-left px-3 py-2 rounded bg-gray-800 text-emerald-400 transition-all duration-150 hover:bg-gray-700 hover:translate-x-0.5">File Info</button>
                            <button data-tab="exif" class="tab-button w-full text-left px-3 py-2 rounded hover:bg-gray-800 transition-all duration-150 hover:translate-x-0.5">EXIF</button>
                            <button data-tab="strings" class="tab-button w-full text-left px-3 py-2 rounded hover:bg-gray-800 transition-all duration-150 hover:translate-x-0.5">Strings</button>
                            <button data-tab="header-footer" class="tab-button w-full text-left px-3 py-2 rounded hover:bg-gray-800 transition-all duration-150 hover:translate-x-0.5">Header/Footer</button>
                            <button data-tab="binwalk" class="tab-button w-full text-left px-3 py-2 rounded hover:bg-gray-800 transition-all duration-150 hover:translate-x-0.5">Binwalk</button>
                            <button data-tab="channels" class="tab-button w-full text-left px-3 py-2 rounded hover:bg-gray-800 transition-all duration-150 hover:translate-x-0.5">Color Channels</button>
                            <button data-tab="enhancements" class="tab-button w-full text-left px-3 py-2 rounded hover:bg-gray-800 transition-all duration-150 hover:translate-x-0.5">Enhancements</button>
                            <button data-tab="bitplanes" class="tab-button w-full text-left px-3 py-2 rounded hover:bg-gray-800 transition-all duration-150 hover:translate-x-0.5">Bit-Planes</button>
                            <button data-tab="lsb" class="tab-button w-full text-left px-3 py-2 rounded hover:bg-gray-800 transition-all duration-150 hover:translate-x-0.5">LSB</button>
                            <button data-tab="zsteg" class="tab-button w-full text-left px-3 py-2 rounded hover:bg-gray-800 transition-all duration-150 hover:translate-x-0.5">zsteg</button>
                            <button data-tab="steghide" class="tab-button w-full text-left px-3 py-2 rounded hover:bg-gray-800 transition-all duration-150 hover:translate-x-0.5">steghide</button>
                            <button data-tab="encodings" class="tab-button w-full text-left px-3 py-2 rounded hover:bg-gray-800 transition-all duration-150 hover:translate-x-0.5">Encodings</button>
                        </nav>
                    </div>

                    <div class="lg:w-2/3">
                        <div class="p-3 border-b border-gray-800 flex items-center justify-between">
                            <h2 id="active-tab-title" class="text-sm font-semibold text-emerald-400 uppercase tracking-wide">File Info</h2>
                        </div>
                        <div id="tab-panels" class="p-4 text-xs space-y-3 lg:max-h-[70vh] lg:overflow-y-auto">
                            <div data-panel="file-info" class="tab-panel">
                                <pre id="file-info-panel" class="text-green-400 whitespace-pre-wrap break-all text-[11px] max-w-full overflow-x-auto"></pre>
                            </div>
                            <div data-panel="exif" class="tab-panel hidden">
                                <pre id="exif-panel" class="text-green-400 whitespace-pre-wrap break-all text-[11px] max-w-full overflow-x-auto"></pre>
                            </div>
                            <div data-panel="strings" class="tab-panel hidden">
                                <div id="strings-panel" class="space-y-2"></div>
                            </div>
                            <div data-panel="header-footer" class="tab-panel hidden">
                                <pre id="header-footer-panel" class="text-green-400 whitespace-pre-wrap break-all text-[11px] max-w-full overflow-x-auto"></pre>
                            </div>
                            <div data-panel="binwalk" class="tab-panel hidden">
                                <pre id="binwalk-panel" class="text-green-400 whitespace-pre-wrap break-all text-[11px] max-w-full overflow-x-auto"></pre>
                            </div>
                            <div data-panel="channels" class="tab-panel hidden">
                                <div id="channels-panel" class="grid grid-cols-2 gap-2"></div>
                            </div>
                            <div data-panel="enhancements" class="tab-panel hidden">
                                <div id="enhancements-panel" class="grid grid-cols-3 gap-2"></div>
                            </div>
                            <div data-panel="bitplanes" class="tab-panel hidden">
                                <div id="bitplanes-panel" class="grid grid-cols-4 gap-2"></div>
                            </div>
                            <div data-panel="lsb" class="tab-panel hidden">
                                <pre id="lsb-panel" class="text-green-400 whitespace-pre-wrap break-all text-[11px] max-w-full overflow-x-auto"></pre>
                            </div>
                            <div data-panel="zsteg" class="tab-panel hidden">
                                <pre id="zsteg-panel" class="text-green-400 whitespace-pre-wrap break-all text-[11px] max-w-full overflow-x-auto"></pre>
                            </div>
                            <div data-panel="steghide" class="tab-panel hidden">
                                <pre id="steghide-panel" class="text-green-400 whitespace-pre-wrap break-all text-[11px] max-w-full overflow-x-auto"></pre>
                            </div>
                            <div data-panel="encodings" class="tab-panel hidden">
                                <pre id="encodings-panel" class="text-green-400 whitespace-pre-wrap break-all text-[11px] max-w-full overflow-x-auto"></pre>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </main>
</div>

<div id="loading-overlay" class="loading-overlay">
    <div class="ring">
        Loading
        <span></span>
    </div>
</div>

<script src="/static/js/main.js"></script>
</body>
</html>

